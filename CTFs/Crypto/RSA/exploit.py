#!/usr/bin/python3
#coding: utf-8

from Crypto.PublicKey import RSA
from pwn import *
import os


file = open("decoder.pub", "r")
key = RSA.importKey(file.read())

n = key.n  # n == p * q
e = key.e
p = 280651103481631199181053614640888768819
q = 303441468941236417171803802700358403049

m = n-(p+q-1)

d = pow(e, -1, m)

log.info(f"n = {n}")
log.info(f"e = {e}")
log.info(f"d = {d}")

key = RSA.construct((n, e, d, p, q))

newFile = open("private.key", "w")
newFile.write(key.exportKey().decode())
newFile.close()

os.system("echo; echo; openssl rsautl -decrypt -inkey private.key -in pass.crypt; echo")
os.remove("private.key")