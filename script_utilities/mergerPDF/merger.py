# type: ignore
import sys
from os import system
from os.path import exists

from PyPDF2 import PdfFileReader, PdfMerger

system("CLS")
print("\n\n")

FILE1_FOUND = exists("1.pdf")
FILE2_FOUND = exists("2.pdf")
FILE3_FOUND = exists("3.pdf")

if not (FILE1_FOUND and FILE2_FOUND):
    print(
        "[ERRO] é necessário os ficheiro 1.pdf e 2.pdf para juntar ao novo ficheiro 3.pdf"
    )
    input("Enter para sair...")
    sys.exit(1)

if FILE3_FOUND:
    print(
        "[Warn] o ficheiro 3.pdf já existe. Deseja substituir? "
        "(Enter para continuar, clicar no [X] para sair)"
    )
    input()

merger = PdfMerger()

doc1 = open("1.pdf", "rb")
doc2 = open("2.pdf", "rb")


total_pages = PdfFileReader(doc1).numPages

for i in range(total_pages):
    merger.append(fileobj=doc1, pages=(i, i + 1))
    merger.append(fileobj=doc2, pages=(total_pages - i - 1, total_pages - i))

output = open("3.pdf", "wb")
merger.write(output)

merger.close()
output.close()

print("\n\nDone =)\n\n")
