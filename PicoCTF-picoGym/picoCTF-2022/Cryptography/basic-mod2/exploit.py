from pwn import log


def decrypt_mod_41_reverse(ciphertext):
	ciphertext = ciphertext.split()
	rules = list(" ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_")
	result = ""
	for char in ciphertext:
		for x in range(50):
			if int(char) * x % 41 == 1:
				result += rules[x]
				break
	return result


encrypted_message = open("message.txt", "r").read()
flag = f"picoCTF{{{decrypt_mod_41_reverse(encrypted_message)}}}"

log.success(f"Flag: {flag}")